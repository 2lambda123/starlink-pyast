<html>
<head>
<style type="text/css">
pre.pycode {display:inline-block;
             background-color:#FFFFDD;
             padding-top:10px;
             padding-bottom:10px;
             padding-left:13px;
             padding-right:13px;
             font-family: monospace;
             border:1px solid #DDD;}
</style>
</head>
<body>

<h2>High level functions</h2>
The <code>starlink.Atl</code> module within PyAST provides a small number of high
level functions that wrap up various other PyAST calls to perform
commonly required operations.

<dl>

<dt><b><big><code>readfitswcs:</code></big></b></dt><dd> Reads an AST FrameSet from a FITS
file. The header from the specified HDU of the specified FITS file is
read, and an AST FrameSet describing the WCS information in the header is
returned. None is returned if WCS information cannot be read from the
header.

<p>Synopsis:<ul>
<pre class="pycode">
frameset = starlink.Atl.readfitswcs( ffile, hdu=0 )
</pre>
<p>
<dl>

<dt><code>ffile</code></dt><dd>A reference to a FITS file, as returned by
<code>pyfits.open()</code>.</dd>

<dt><code>hdu</code></dt><dd>The integer index of the required HDU (zero for the
primary HDU).</dd>

</dl></ul>

<p>Example:<ul>
<pre class="pycode">
>>> import pyfits
>>> import starlink.Atl as Atl
>>>
>>> ffile = pyfits.open( 'test.fit' )
>>> frameset = Atl.readfitswcs( ffile )
>>> if frameset == None:
>>>    print( "Cannot read WCS from test.fit" )
</pre>
</ul>

</dd>

<dt><b><big><code>plotfitswcs:</code></big></b></dt><dd>
Read WCS from a FITS image and plot an annotated coordinate grid
in a matplotlib axes area. The grid covers the entire image. The function
returns a reference to the Plot that was used to draw
the axes.

<p>Synopsis:<ul>
<pre class="pycode">
plot = starlink.Atl.plotfitswcs( axes, gbox, ffile, hdu=0, options="" )
</pre>
<p>
<dl>

<dt><code>axes</code></dt><dd>A matplot lib "Axes" object. The annotated axes
normally produced by matplotlib will be removed, and axes will instead be
drawn by the AST Plot class</dd>

<dt><code>gbox</code></dt><dd>A list of four values giving the bounds of the new
annotated axes within the matplotlib Axes object. The supplied values
should be in the order (xleft,ybottom,xright,ytop) and should be given in
the matplotlib "axes" coordinate system.</dd>

<dt><code>ffile</code></dt><dd>A reference to a FITS file, as returned by
<code>pyfits.open()</code>.</dd>

<dt><code>hdu</code></dt><dd>The integer index of the required HDU (zero for the
primary HDU).</dd>

<dt><code>options</code></dt><dd>An optional string holding a comma-separated list of
Plot attribute settings. These control the appearance of the annotated
axes.</dd>

</dl></ul>

<p>Example:<ul>
<pre class="pycode">
>>> import pyfits
>>> import starlink.Atl as Atl
>>> import matplotlib.pyplot
>>>
>>> ffile = pyfits.open( 'test.fit' )
>>> Atl.plotfitswcs( matplotlib.pyplot.figure().add_subplot(111),
>>>                  [ 0.1, 0.1, 0.9, 0.9 ], ffile )
>>> matplotlib.pyplot.show()
</pre>
</ul>

</dd>

<dt><b><big><code>plotframeset:</code></big></b></dt><dd> Plot an annotated coordinate
grid in a matplotlib axes area.The function returns a reference to the
Plot that was used to draw the axes.

<p>Synopsis:<ul>
<pre class="pycode">
plot =  starlink.Atl.plotframeset( axes, gbox, bbox, frameset, options="" )
</pre>
<p>
<dl>

<dt><code>axes</code></dt><dd>A matplot lib "Axes" object. The annotated axes
normally produced by matplotlib will be removed, and axes will instead be
drawn by the AST Plot class</dd>

<dt><code>gbox</code></dt><dd>A list of four values giving the bounds of the new
annotated axes within the matplotlib Axes object. The supplied values
should be in the order (xleft,ybottom,xright,ytop) and should be given in
the matplotlib "axes" coordinate system.</dd>

<dt><code>bbox</code></dt><dd>A list of four values giving the bounds of the new
annotated axes within the coordinate system represented by the base Frame
of the supplied FrameSet. The supplied values should be in the order
(xleft,ybottom,xright,ytop).

<dt><code>frameset</code></dt><dd>An AST FrameSet such as returned by the
<code>starlink.Atl.readfits</code> function. Its base Frame should be
2-dimensional.

<dt><code>options</code></dt><dd>An optional string holding a comma-separated list of
Plot attribute settings. These control the appearance of the annotated
axes.</dd>

</dl></ul>

<p>Example:<ul>
<pre class="pycode">
>>> import pyfits
>>> import starlink.Atl as Atl
>>> import matplotlib.pyplot
>>>
>>> ffile = pyfits.open( 'test.fit' )
>>> frameset = starlink.Atl.readfitswcs( ffile )
>>> if frameset != None:
>>>    naxis1 = ffile[0].header['NAXIS1']
>>>    naxis2 = ffile[0].header['NAXIS2']
>>>    Atl.plotframeset( matplotlib.pyplot.figure().add_subplot(111),
>>>                      [ 0.1, 0.1, 0.9, 0.9 ],
>>>                      [ 0.5, 0.5, naxis1+0.5, naxis2+0.5 ], frameset )
>>>    matplotlib.pyplot.show()
</pre>
</ul>

</dd>























<dt><b><big><code id="pyfitsadapter">PyFITSAdapter:</code></big></b></dt><dd> A class that
provides an adapter between the <code>starlink.Ast.FitsChan</code> class
and the header class provided by <a
href="http://www.stsci.edu/resources/software_hardware/pyfits">PyFITS</a>.
This allows the <Code>fitschan.read()</code> method to read header cards
from a PyFITS header, and the <Code>fitschan.write()</code> method to
write header cards to a PyFITS header. The class provides a public
constructor, but no public methods.

<p>Synopsis:<ul>
<pre class="pycode">
pyfitsadapter =  starlink.Atl.PyFITSAdapter( hdu )
</pre>
<p>
<dl>

<dt><code>hdulist</code></dt><dd>An <code>hdulist</code> such as returned
by "</code>pyfits.open()</code>", or an element of the
<code>hdulist</code>. If the whole <code>hdulist</code> is provided, then
element zero (the primary HDU) is used.</dd>

</dl></ul>

<p>Example:<ul>
<pre class="pycode">
>>> import pyfits
>>> import starlink.Atl as Atl
>>> import starlink.Ast as Ast
>>> import matplotlib.pyplot
>>>
>>> ffile = pyfits.open( 'test.fit' )
>>> adapter = Atl.PyFITSAdapter( ffile[ 1 ] )
>>> fc = Ast.FitsChan( adapter, adapter )
>>> frameset = fc.read()
>>> fc.writefits()
</pre>
<p>
This example fills a FitsChan with the headers from the first extension
in 'test.fit'. It then reads WCS information from the FitsChan. Since
FitsChan reads are destructive, this causes all the WCS-related keywords
to be deleted from the FitsChan. The remaining non-WCS keywords are then
written out to the original PyAST header (the PyAST header is empted
first). The net effect is to remove all WCS keywords from the PyAST header.
</ul>
</dd>







</dl>
</body>
</html>
